# LME Copper Analysis - Technical Guide

## システム概要

このシステムは、LME（ロンドン金属取引所）銅のCash/3Mスプレッド分析を包括的に実行するためのプラットフォームです。

## アーキテクチャ

### データフロー
1. **データ取得**: Refinitiv EIKON API → PostgreSQL
2. **前処理**: データクリーニング・特徴量エンジニアリング  
3. **分析**: 統計分析・機械学習モデリング
4. **予測**: 時系列予測・トレーディングシグナル
5. **リスク管理**: VaR・ポートフォリオ管理

### 主要コンポーネント

#### データ取得システム
- `data_collection/`: Refinitiv APIを使用したデータ収集
- `automation/`: 自動データ更新スケジューラ
- `database/`: PostgreSQL データベース管理

#### 分析エンジン
- `analysis_notebooks/`: Jupyter Notebook分析
- `src/models.py`: 機械学習モデル実装
- `src/trading_signals.py`: シグナル生成ロジック

#### リスク管理
- `src/risk_management.py`: VaR・リスク指標計算
- `src/backtesting.py`: 戦略バックテスト

## RIC コード体系

### 主要RIC
- `CMCU0-3`: Cash/3M スプレッド（直接）
- `CMCU0`: Cash/現物価格
- `CMCU3`: 3ヶ月先物価格
- `MCUSTX-TOTAL`: LME銅総在庫

### データ品質
- **更新頻度**: 平日日次（営業日のみ）
- **データ範囲**: 2020年〜現在
- **欠損値処理**: 前方埋め・線形補間

## 機械学習パイプライン

### 特徴量エンジニアリング
```python
features = [
    'lag_1', 'lag_5', 'lag_10',      # ラグ特徴量
    'ma_5', 'ma_20', 'ma_50',        # 移動平均
    'volatility_20',                 # ボラティリティ
    'rsi_14',                        # RSI
    'bb_position',                   # ボリンジャーバンド位置
    'day_of_week', 'month'           # 時間特徴量
]
```

### モデル評価指標
- **精度指標**: MAE, RMSE, MAPE, R²
- **方向性指標**: 方向的中率、精度・再現率
- **リスク調整**: シャープレシオ、最大ドローダウン

## 運用ガイドライン

### 毎日の運用
1. データ更新確認
2. モデル予測実行  
3. シグナル生成
4. リスク指標更新

### 週次メンテナンス
1. データ品質チェック
2. モデル性能評価
3. パラメータ調整

### 月次見直し
1. モデル再訓練
2. 戦略パフォーマンス評価
3. リスク管理見直し

## トラブルシューティング

### よくある問題

#### データ取得エラー
- API制限: レート制限確認・待機時間調整
- RIC無効: 代替RIC使用・期間調整
- 接続エラー: ネットワーク・認証確認

#### モデル性能低下
- 過学習: 正則化・検証データ確認
- データドリフト: 特徴量分布確認・再訓練
- 概念ドリフト: モデル更新・アンサンブル調整

#### システムエラー
- メモリ不足: バッチサイズ削減・データ分割
- DB接続: コネクションプール調整
- 計算リソース: 並列化・クラウド活用

## セキュリティ

### API キー管理
- 環境変数での管理
- 暗号化ストレージ使用
- アクセス権限最小化

### データベース
- SSL接続強制
- ユーザー権限分離
- 定期バックアップ

## パフォーマンス最適化

### データベース
- インデックス最適化
- クエリ最適化
- 接続プール調整

### 機械学習
- 特徴量選択
- ハイパーパラメータ最適化
- 分散学習活用